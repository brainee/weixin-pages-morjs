{"version":3,"file":"components/goods-card/index.js","mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///./components/goods-card/index.js"],"sourcesContent":["var __MOR_COMPONENT__ = require('@morjs/core').createComponent;\n\n\"use strict\";\n__MOR_COMPONENT__({\n    options: {\n        addGlobalClass: true,\n    },\n    properties: {\n        id: {\n            type: String,\n            value: '',\n            observer(id) {\n                var _a;\n                this.genIndependentID(id);\n                if ((_a = this.properties.thresholds) === null || _a === void 0 ? void 0 : _a.length) {\n                    this.createIntersectionObserverHandle();\n                }\n            },\n        },\n        data: {\n            type: Object,\n            observer(data) {\n                if (!data) {\n                    return;\n                }\n                let isValidityLinePrice = true;\n                if (data.originPrice && data.price && data.originPrice < data.price) {\n                    isValidityLinePrice = false;\n                }\n                this.setData({ goods: data, isValidityLinePrice });\n            },\n        },\n        currency: {\n            type: String,\n            value: 'Â¥',\n        },\n        thresholds: {\n            type: Array,\n            value: [],\n            observer(thresholds) {\n                if (thresholds && thresholds.length) {\n                    this.createIntersectionObserverHandle();\n                }\n                else {\n                    this.clearIntersectionObserverHandle();\n                }\n            },\n        },\n    },\n    data: {\n        independentID: '',\n        goods: { id: '' },\n        isValidityLinePrice: false,\n    },\n    lifetimes: {\n        ready() {\n            this.init();\n        },\n        detached() {\n            this.clear();\n        },\n    },\n    pageLifeTimes: {},\n    methods: {\n        clickHandle() {\n            this.triggerEvent('click', { goods: this.data.goods });\n        },\n        clickThumbHandle() {\n            this.triggerEvent('thumb', { goods: this.data.goods });\n        },\n        addCartHandle(e) {\n            const { id } = e.currentTarget;\n            const { id: cardID } = e.currentTarget.dataset;\n            this.triggerEvent('add-cart', Object.assign(Object.assign({}, e.detail), { id,\n                cardID, goods: this.data.goods }));\n        },\n        genIndependentID(id) {\n            let independentID;\n            if (id) {\n                independentID = id;\n            }\n            else {\n                independentID = `goods-card-${~~(Math.random() * Math.pow(10, 8))}`;\n            }\n            this.setData({ independentID });\n        },\n        init() {\n            const { thresholds, id } = this.properties;\n            this.genIndependentID(id);\n            if (thresholds && thresholds.length) {\n                this.createIntersectionObserverHandle();\n            }\n        },\n        clear() {\n            this.clearIntersectionObserverHandle();\n        },\n        intersectionObserverContext: null,\n        createIntersectionObserverHandle() {\n            if (this.intersectionObserverContext || !this.data.independentID) {\n                return;\n            }\n            this.intersectionObserverContext = this.createIntersectionObserver({\n                thresholds: this.properties.thresholds,\n            }).relativeToViewport();\n            this.intersectionObserverContext.observe(`#${this.data.independentID}`, (res) => {\n                this.intersectionObserverCB(res);\n            });\n        },\n        intersectionObserverCB() {\n            this.triggerEvent('ob', {\n                goods: this.data.goods,\n                context: this.intersectionObserverContext,\n            });\n        },\n        clearIntersectionObserverHandle() {\n            if (this.intersectionObserverContext) {\n                try {\n                    this.intersectionObserverContext.disconnect();\n                }\n                catch (e) { }\n                this.intersectionObserverContext = null;\n            }\n        },\n    },\n}, \"w\");\n"],"names":[],"sourceRoot":""}