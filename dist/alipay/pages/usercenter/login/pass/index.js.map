{"version":3,"file":"pages/usercenter/login/pass/index.js","mappings":";;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///./pages/usercenter/login/pass/index.js"],"sourcesContent":["var __MOR_PAGE__ = require('@morjs/core').createPage;\n\nvar __MOR_API__ = require('@morjs/api').mor;\n\nimport { __awaiter } from \"tslib\";\n// pages/usercenter/validate-code/index.ts\nimport { getCurrentPageParam } from '../../../../utils/queryString';\nimport { wxLogin, getAccountSession } from '../../../../services/usercenter/loginService';\n__MOR_PAGE__({\n    /**\n     * 页面的初始数据\n     */\n    data: {\n        account: \"\",\n        showPassword: false,\n        formData: {},\n        stepDisabled: true,\n    },\n    /* 生命周期函数--监听页面加载 */\n    onLoad: function (options) {\n        // console.log(\"[zy]options=\",options);\n        let { account } = getCurrentPageParam() || {};\n        console.log(\"[zy]got from last page:account\", account);\n        this.setData({ account });\n    },\n    changEye: function () {\n        this.setData({\n            showPassword: !this.data.showPassword\n        });\n    },\n    inputChange: function (e) {\n        let prop = e.currentTarget.dataset.prop;\n        let value = e.detail.value;\n        this.setData({ stepDisabled: !value });\n        this.data.formData[prop] = value;\n        this.setData({\n            formData: this.data.formData\n        });\n    },\n    regain() {\n        let { account, } = this.data;\n        __MOR_API__.navigateTo({ url: `/pages/usercenter/reset/account/index?account=${account}&operate=reset` });\n    },\n    switchCode() {\n        console.log(\"[zy]switchCode\");\n        __MOR_API__.navigateBack();\n    },\n    login: function (res) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            let account = this.data.account;\n            let password = this.data.formData.password;\n            const App = getApp();\n            let { openid, unionid } = (_a = App === null || App === void 0 ? void 0 : App.globalData) === null || _a === void 0 ? void 0 : _a.session;\n            if (!account) {\n                __MOR_API__.showToast({\n                    icon: 'none',\n                    title: \"账号不能为空\",\n                });\n                return;\n            }\n            if (!password) {\n                __MOR_API__.showToast({\n                    icon: 'none',\n                    title: \"密码不能为空\",\n                });\n                return;\n            }\n            if (!openid) {\n                __MOR_API__.showToast({\n                    icon: 'none',\n                    title: \"需要先登录小程序\",\n                });\n                yield wxLogin();\n                return;\n            }\n            getAccountSession({\n                account,\n                password,\n                openid,\n                unionid,\n            }).then((data) => {\n                var _a, _b, _c;\n                if ((_a = data === null || data === void 0 ? void 0 : data.loginResponse) === null || _a === void 0 ? void 0 : _a.flag) {\n                    __MOR_API__.switchTab({ url: '/pages/cart/index' });\n                }\n                else if ((_b = data === null || data === void 0 ? void 0 : data.loginResponse) === null || _b === void 0 ? void 0 : _b.errorMsg) {\n                    __MOR_API__.showToast({ title: (_c = data === null || data === void 0 ? void 0 : data.loginResponse) === null || _c === void 0 ? void 0 : _c.errorMsg });\n                }\n                else {\n                    __MOR_API__.showToast({ title: \"登录失败，请检查登录名称和密码\" });\n                }\n            });\n        });\n    },\n    /**\n     * 生命周期函数--监听页面显示\n     */\n    onShow() {\n    },\n    /**\n     * 生命周期函数--监听页面隐藏\n     */\n    onHide() {\n    },\n    /**\n     * 生命周期函数--监听页面卸载\n     */\n    onUnload() {\n    },\n    /**\n     * 页面相关事件处理函数--监听用户下拉动作\n     */\n    onPullDownRefresh() {\n    },\n    /**\n     * 页面上拉触底事件的处理函数\n     */\n    onReachBottom() {\n    },\n    /**\n     * 用户点击右上角分享\n     */\n    onShareAppMessage() {\n    }\n}, \"w\");\n"],"names":[],"sourceRoot":""}