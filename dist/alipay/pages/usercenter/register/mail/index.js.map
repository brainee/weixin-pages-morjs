{"version":3,"file":"pages/usercenter/register/mail/index.js","mappings":";;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AC3TA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///./model/airline/index.js","webpack:///./model/airport/index.js","webpack:///./pages/usercenter/register/mail/index.js","webpack:///./services/airline/index.js","webpack:///./services/airport/index.js"],"sourcesContent":["\"use strict\";\nimport { request } from \"../../utils/request\";\nimport { domain } from \"../../config/index\";\nconst findAirlinesUrl = domain + `/api/findAirlines`;\nexport function findAirlines(params) {\n  let prefix = \"[zy]findAirlines model\";\n  let url = findAirlinesUrl;\n  console.log(prefix, \"request start\", url);\n  return request({\n    url,\n    data: params,\n    method: \"POST\"\n  }).then((e) => {\n    console.log(prefix, \"request success\", e);\n    return e;\n  }).catch((e) => {\n    console.log(prefix, \"request fail\", e);\n  });\n}\n","\"use strict\";\nimport { request } from \"../../utils/request\";\nimport { domain } from \"../../config/index\";\nconst searchAreaUrl = domain + `/api/searchArea`;\nexport function searchArea(params) {\n  let prefix = \"[zy]searchArea model\";\n  let url = searchAreaUrl;\n  console.log(prefix, \"request start\", url);\n  return request({\n    url,\n    data: params,\n    method: \"POST\"\n  }).then((e) => {\n    console.log(prefix, \"request success\", e);\n    return e;\n  }).catch((e) => {\n    console.log(prefix, \"request fail\", e);\n  });\n}\n","var __MOR_PAGE__ = require('@morjs/core').createPage;\n\nvar __MOR_API__ = require('@morjs/api').mor;\n\nimport { __awaiter } from \"tslib\";\n// pages/usercenter/validate-code/index.ts\nimport { getCurrentPageParam } from '../../../../utils/queryString';\nimport { wxLogin, } from '../../../../services/usercenter/loginService';\nimport { trialService } from '../../../../services/usercenter/registerService';\nimport { config } from '../../../../config/index';\nimport { searchAreaService } from '../../../../services/airport/index';\nimport { findAirlinesService } from '../../../../services/airline/index';\n__MOR_PAGE__({\n    /**\n     * 页面的初始数据\n     */\n    data: {\n        mykeys: {\n            label: \"areaName\",\n            value: \"areaCode\",\n        },\n        account: \"\",\n        formData: {},\n        stepDisabled: true,\n        unitShowText: '',\n        unitTitle: '',\n        unitText: '',\n        unitValue: [],\n        airportText: '',\n        airportValue: [],\n        airportTitle: '',\n        airlineText: '',\n        airlineValue: [],\n        airlineTitle: '',\n        units: [\n            { label: \"机场\", value: \"1\", key: \"airport\" },\n            { label: \"航司\", value: \"2\", key: \"airline\" },\n            { label: \"其他\", value: \"3\", key: \"other\" },\n        ],\n        citys: [\n            { label: '北京市', value: '北京市' },\n            { label: '上海市', value: '上海市' },\n            { label: '广州市', value: '广州市' },\n            { label: '深圳市', value: '深圳市' },\n            { label: '成都市', value: '成都市' },\n        ],\n        airlines: []\n    },\n    /* 生命周期函数--监听页面加载 */\n    onLoad: function (options) {\n        // console.log(\"[zy]options=\",options);\n        let { account, operate, } = getCurrentPageParam() || {};\n        console.log(\"[zy]got from last page:account\", account, operate);\n        this.setData({ account, operate });\n        let pass = this.checkBase();\n        // if(!pass){\n        //   return;\n        // }\n        this.searchArea();\n        this.findAirlines();\n    },\n    searchArea() {\n        searchAreaService({\n            \"head\": { \"uid\": \"\", \"token\": \"\", \"requestTime\": \"2024-04-07T02:18:21.282Z\", \"appId\": \"\", \"clientType\": \"1\", \"clientVersion\": \"\", \"moduleCode\": \"common\", \"chartTableCode\": null },\n            \"type\": 1\n        }).then(data => {\n            if ((data === null || data === void 0 ? void 0 : data.length) > 0) {\n                this.setData({ citys: data });\n            }\n        });\n    },\n    findAirlines() {\n        findAirlinesService({\n            \"head\": { \"uid\": \"\", \"token\": \"\", \"requestTime\": \"2024-04-07T02:18:25.687Z\", \"appId\": \"\", \"clientType\": \"1\", \"clientVersion\": \"\", \"moduleCode\": \"common\", \"chartTableCode\": null },\n            \"type\": 1\n        }).then(data => {\n            if ((data === null || data === void 0 ? void 0 : data.length) > 0) {\n                this.setData({ airlines: data });\n            }\n        });\n    },\n    onPickOfCascader(e) {\n        let prefix = \"[zy]onPickOfCascader\";\n        console.log(prefix, e.detail);\n    },\n    onChangeOfCascader(e) {\n        var _a;\n        let prefix = \"[zy]onChangeOfCascader\";\n        const { selectedOptions, value } = e.detail;\n        let { unitText } = this.data;\n        let airportText = (_a = selectedOptions[(selectedOptions === null || selectedOptions === void 0 ? void 0 : selectedOptions.length) - 1]) === null || _a === void 0 ? void 0 : _a.areaName;\n        console.log(prefix, e.detail);\n        this.setData({\n            airportValue: [value],\n            airportText,\n            airportVisible: false,\n            unitShowText: `${unitText}:${airportText}`,\n        });\n    },\n    inputChange: function (e) {\n        let prop = e.currentTarget.dataset.prop;\n        let value = e.detail.value;\n        this.setData({ stepDisabled: !value });\n        this.data.formData[prop] = value;\n        this.setData({\n            formData: this.data.formData\n        });\n    },\n    onColumnChange(e) {\n        console.log('picker pick:', e);\n    },\n    onPickerChangeOfAirline(e) {\n        const { key } = e.currentTarget.dataset;\n        const { label, value, } = e.detail;\n        let { unitText } = this.data;\n        let airlineText = label.join(' ');\n        console.log('picker change:', e.detail);\n        this.setData({\n            [`${key}Visible`]: false,\n            [`${key}Value`]: value,\n            [`${key}Text`]: label.join(' '),\n            unitShowText: `${unitText}:${airlineText}`,\n        });\n    },\n    onPickerChangeOfUnit(e) {\n        const { key } = e.currentTarget.dataset;\n        const { label, value } = e.detail;\n        let unitTypeKeys = this.data.units.map(unit => unit.key); //[\"airport\", \"airline\", \"other\"]\n        let unitTypeTitles = this.data.units.map(unit => unit.label);\n        let index = value[0] - 1;\n        let typeKey = unitTypeKeys[index];\n        let typeTitle = unitTypeTitles[index];\n        console.log('picker change:', typeKey, e.detail);\n        let note = label.join(' ');\n        this.setData({\n            [`${key}Visible`]: false,\n            [`${key}Value`]: value,\n            [`${key}Text`]: note,\n            [`${typeKey}Visible`]: true,\n            [`${typeKey}Title`]: \"选择\" + typeTitle,\n            unitShowText: note,\n        });\n    },\n    onPickerCancel(e) {\n        const { key } = e.currentTarget.dataset;\n        console.log(e, '取消');\n        console.log('picker1 cancel:');\n        this.setData({\n            [`${key}Visible`]: false,\n        });\n    },\n    onTitlePicker() {\n        this.setData({ unitVisible: true, unitTitle: '选择单位' });\n    },\n    inputChange2: function (e) {\n        let prop = e.currentTarget.dataset.prop;\n        let value = e.detail.value;\n        this.data.formData[prop] = value;\n        this.setData({\n            formData: this.data.formData\n        });\n    },\n    inputChangeNormal(e) {\n        let prop = e.currentTarget.dataset.prop;\n        let value = e.detail.value;\n        this.data.formData[prop] = value;\n        this.setData({\n            formData: this.data.formData\n        });\n        let pass = this.check();\n        this.setData({ stepDisabled: !pass });\n    },\n    getMainUnit() {\n        let { unitValue, airportText, airportValue, airlineText, airlineValue } = this.data;\n        let { unit } = this.data.formData;\n        let mainUnitName = \"\", mainUnitCode = \"\";\n        let demoType = +unitValue[0] || 0;\n        if (demoType === 1) {\n            mainUnitName = airportText,\n                mainUnitCode = airportValue[0];\n        }\n        else if (demoType === 2) {\n            mainUnitName = airlineText,\n                mainUnitCode = airlineValue[0];\n        }\n        else {\n            mainUnitName = unit;\n        }\n        return {\n            mainUnitName,\n            mainUnitCode,\n            demoType,\n        };\n    },\n    checkBase() {\n        var _a;\n        let { account, } = this.data;\n        if (!account) {\n            __MOR_API__.showToast({\n                icon: 'none',\n                title: \"账号不能为空\",\n            });\n            return;\n        }\n        const App = getApp();\n        let { openid, unionid } = (_a = App === null || App === void 0 ? void 0 : App.globalData) === null || _a === void 0 ? void 0 : _a.session;\n        if (!openid) {\n            __MOR_API__.showToast({\n                icon: 'none',\n                title: \"需要先登录小程序\",\n            });\n            wxLogin();\n            return;\n        }\n        return true;\n    },\n    check(showTip) {\n        let { name, depart, mail, } = this.data.formData;\n        let { mainUnitName, mainUnitCode } = this.getMainUnit();\n        if (!name) {\n            showTip && __MOR_API__.showToast({\n                icon: 'none',\n                title: \"真实姓名不能为空\",\n            });\n            return;\n        }\n        if (!depart) {\n            showTip && __MOR_API__.showToast({\n                icon: 'none',\n                title: \"部门不能为空\",\n            });\n            return;\n        }\n        if (!mail) {\n            showTip && __MOR_API__.showToast({\n                icon: 'none',\n                title: \"邮箱不能为空\",\n            });\n            return;\n        }\n        if (!mainUnitName) {\n            showTip && __MOR_API__.showToast({\n                icon: 'none',\n                title: \"单位不能为空\",\n            });\n            return;\n        }\n        return true;\n    },\n    submit: function (res) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            let pass = this.check(true);\n            if (!pass)\n                return;\n            let { account, } = this.data;\n            let { name, depart, mail, } = this.data.formData;\n            const App = getApp();\n            let { openid, unionid } = (_a = App === null || App === void 0 ? void 0 : App.globalData) === null || _a === void 0 ? void 0 : _a.session;\n            let { mainUnitName, mainUnitCode, demoType, } = this.getMainUnit();\n            trialService({\n                name,\n                mobileprefix: config.default_mobile_prefix,\n                mobile: account,\n                mail,\n                mainUnitName,\n                mainUnitCode,\n                remark: \"\",\n                depart,\n                title: \"\",\n                budget: 0,\n                persons: 0,\n                demoType,\n                openid,\n                unionid,\n            }).then((data) => {\n                if (data) {\n                    __MOR_API__.navigateTo({ url: '/pages/usercenter/register/finish/index' });\n                }\n                else {\n                    __MOR_API__.showToast({ title: \" 注册失败，请重试\" });\n                }\n            });\n        });\n    },\n    /**\n     * 生命周期函数--监听页面显示\n     */\n    onShow() {\n    },\n    /**\n     * 生命周期函数--监听页面隐藏\n     */\n    onHide() {\n    },\n    /**\n     * 生命周期函数--监听页面卸载\n     */\n    onUnload() {\n    },\n    /**\n     * 页面相关事件处理函数--监听用户下拉动作\n     */\n    onPullDownRefresh() {\n    },\n    /**\n     * 页面上拉触底事件的处理函数\n     */\n    onReachBottom() {\n    },\n    /**\n     * 用户点击右上角分享\n     */\n    onShareAppMessage() {\n    }\n}, \"w\");\n","\"use strict\";\nimport { findAirlines } from \"../../model/airline/index\";\nexport function findAirlinesService(params) {\n  let prefix = \"[zy]findAirlinesService\";\n  console.log(prefix, \"service start\", params);\n  return findAirlines(params).then((res) => {\n    console.log(prefix, \"service got\", res);\n    if (res.data) {\n      return res.data.map((airline) => {\n        return { label: airline.airlinesName, value: airline.airlinesCode };\n      });\n    }\n  });\n}\n","\"use strict\";\nimport { searchArea } from \"../../model/airport/index\";\nexport function searchAreaService(params) {\n  let prefix = \"[zy]searchAreaService\";\n  console.log(prefix, \"service start\", params);\n  return searchArea(params).then((res) => {\n    if (res == null ? void 0 : res.data) {\n      return res.data;\n    }\n  });\n}\n"],"names":[],"sourceRoot":""}