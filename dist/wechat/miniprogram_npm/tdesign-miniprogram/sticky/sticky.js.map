{"version":3,"file":"miniprogram_npm/tdesign-miniprogram/sticky/sticky.js","mappings":";;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///./miniprogram_npm/tdesign-miniprogram/mixins/page-scroll.js","webpack:///./miniprogram_npm/tdesign-miniprogram/sticky/props.js","webpack:///./miniprogram_npm/tdesign-miniprogram/sticky/sticky.js"],"sourcesContent":["import { getCurrentPage } from '../common/utils';\nvar onPageScroll = function (event) {\n    var page = getCurrentPage();\n    if (!page)\n        return;\n    var pageScroller = page.pageScroller;\n    pageScroller === null || pageScroller === void 0 ? void 0 : pageScroller.forEach(function (scroller) {\n        if (typeof scroller === 'function') {\n            scroller(event);\n        }\n    });\n};\nexport default (function (funcName) {\n    if (funcName === void 0) { funcName = 'onScroll'; }\n    return Behavior({\n        attached: function () {\n            var _a;\n            var page = getCurrentPage();\n            if (!page)\n                return;\n            var bindScroller = (_a = this[funcName]) === null || _a === void 0 ? void 0 : _a.bind(this);\n            if (bindScroller) {\n                this._pageScroller = bindScroller;\n            }\n            if (Array.isArray(page.pageScroller)) {\n                page.pageScroller.push(bindScroller);\n            }\n            else {\n                page.pageScroller =\n                    typeof page.onPageScroll === 'function' ? [page.onPageScroll.bind(page), bindScroller] : [bindScroller];\n            }\n            page.onPageScroll = onPageScroll;\n        },\n        detached: function () {\n            var _this = this;\n            var _a;\n            var page = getCurrentPage();\n            if (!page)\n                return;\n            page.pageScroller = ((_a = page.pageScroller) === null || _a === void 0 ? void 0 : _a.filter(function (item) { return item !== _this._pageScroller; })) || [];\n        },\n    });\n});\n","var props = {\n    container: {\n        type: null,\n    },\n    disabled: {\n        type: Boolean,\n        value: false,\n    },\n    externalClasses: {\n        type: Array,\n    },\n    offsetTop: {\n        type: Number,\n        value: 0,\n    },\n    zIndex: {\n        type: Number,\n        value: 99,\n    },\n};\nexport default props;\n","import { __extends } from \"tslib\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\")\n        r = Reflect.decorate(decorators, target, key, desc);\n    else\n        for (var i = decorators.length - 1; i >= 0; i--)\n            if (d = decorators[i])\n                r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { SuperComponent, wxComponent } from '../common/src/index';\nimport props from './props';\nimport config from '../common/config';\nimport pageScrollMixin from '../mixins/page-scroll';\nimport { getRect } from '../common/utils';\nvar prefix = config.prefix;\nvar name = prefix + \"-sticky\";\nvar ContainerClass = \".\" + name;\nvar Sticky = /** @class */ (function (_super) {\n    __extends(Sticky, _super);\n    function Sticky() {\n        var _this = _super.apply(this, arguments) || this;\n        _this.externalClasses = [prefix + \"-class\", prefix + \"-class-content\"];\n        _this.properties = props;\n        _this.behaviors = [pageScrollMixin()];\n        _this.observers = {\n            'offsetTop, disabled, container': function () {\n                this.onScroll();\n            },\n        };\n        _this.data = {\n            prefix: prefix,\n            classPrefix: name,\n            containerStyle: '',\n            contentStyle: '',\n        };\n        _this.methods = {\n            onScroll: function (event) {\n                var _this = this;\n                var scrollTop = (event || {}).scrollTop;\n                var _a = this.properties, container = _a.container, offsetTop = _a.offsetTop, disabled = _a.disabled;\n                if (disabled) {\n                    this.setDataAfterDiff({\n                        isFixed: false,\n                        transform: 0,\n                    });\n                    return;\n                }\n                this.scrollTop = scrollTop || this.scrollTop;\n                if (typeof container === 'function') {\n                    Promise.all([getRect(this, ContainerClass), this.getContainerRect()]).then(function (_a) {\n                        var root = _a[0], container = _a[1];\n                        if (!root || !container)\n                            return;\n                        if (offsetTop + root.height > container.height + container.top) {\n                            _this.setDataAfterDiff({\n                                isFixed: false,\n                                transform: container.height - root.height,\n                            });\n                        }\n                        else if (offsetTop >= root.top) {\n                            _this.setDataAfterDiff({\n                                isFixed: true,\n                                height: root.height,\n                                transform: 0,\n                            });\n                        }\n                        else {\n                            _this.setDataAfterDiff({ isFixed: false, transform: 0 });\n                        }\n                    });\n                    return;\n                }\n                getRect(this, ContainerClass).then(function (root) {\n                    if (!root)\n                        return;\n                    if (offsetTop >= root.top) {\n                        _this.setDataAfterDiff({ isFixed: true, height: root.height });\n                        _this.transform = 0;\n                    }\n                    else {\n                        _this.setDataAfterDiff({ isFixed: false });\n                    }\n                });\n            },\n            setDataAfterDiff: function (data) {\n                var _this = this;\n                var offsetTop = this.properties.offsetTop;\n                var _a = this.data, prevContainerStyle = _a.containerStyle, prevContentStyle = _a.contentStyle;\n                var isFixed = data.isFixed, height = data.height, transform = data.transform;\n                wx.nextTick(function () {\n                    var containerStyle = '';\n                    var contentStyle = '';\n                    if (isFixed) {\n                        containerStyle += \"height:\" + height + \"px;\";\n                        contentStyle += \"position:fixed;top:\" + offsetTop + \"px;left:0;right:0;\";\n                    }\n                    if (transform) {\n                        var translate = \"translate3d(0, \" + transform + \"px, 0)\";\n                        contentStyle += \"-webkit-transform:\" + translate + \";transform:\" + translate + \";\";\n                    }\n                    if (prevContainerStyle !== containerStyle || prevContentStyle !== contentStyle) {\n                        _this.setData({ containerStyle: containerStyle, contentStyle: contentStyle });\n                    }\n                    _this.triggerEvent('scroll', {\n                        scrollTop: _this.scrollTop,\n                        isFixed: isFixed,\n                    });\n                });\n            },\n            getContainerRect: function () {\n                var nodesRef = this.properties.container();\n                return new Promise(function (resolve) { return nodesRef.boundingClientRect(resolve).exec(); });\n            },\n        };\n        return _this;\n    }\n    Sticky.prototype.ready = function () {\n        this.onScroll();\n    };\n    return Sticky;\n}(SuperComponent));\nSticky = __decorate([\n    wxComponent()\n], Sticky);\nexport default Sticky;\n"],"names":[],"sourceRoot":""}