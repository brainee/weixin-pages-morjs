{"version":3,"file":"pages/usercenter/login/login.js","mappings":";;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///./pages/usercenter/login/login.js"],"sourcesContent":["import { wxLogin, getAccountSession, phoneLoginService } from '../../../services/usercenter/loginService';\nvar App = getApp();\nPage({\n    data: {\n        formData: {},\n        showPassword: false,\n        accountLogin: \"账号登录\",\n        disabled: false,\n    },\n    changEye: function () {\n        this.setData({\n            showPassword: !this.data.showPassword\n        });\n    },\n    inputChange: function (e) {\n        var prop = e.currentTarget.dataset.prop;\n        var value = e.detail.value;\n        this.data.formData[prop] = value;\n        this.setData({\n            formData: this.data.formData\n        });\n    },\n    login: function (res) {\n        var _a;\n        var account = this.data.formData.account;\n        var password = this.data.formData.password;\n        var _b = (_a = App === null || App === void 0 ? void 0 : App.globalData) === null || _a === void 0 ? void 0 : _a.session, openid = _b.openid, unionid = _b.unionid;\n        if (!account) {\n            wx.showToast({\n                icon: 'none',\n                title: \"账号不能为空\",\n            });\n            return;\n        }\n        if (!password) {\n            wx.showToast({\n                icon: 'none',\n                title: \"密码不能为空\",\n            });\n            return;\n        }\n        if (!openid) {\n            wx.showToast({\n                icon: 'none',\n                title: \"需要先登录小程序\",\n            });\n            return;\n        }\n        getAccountSession({\n            account: account,\n            password: password,\n            openid: openid,\n            unionid: unionid,\n        }).then(function (data) {\n            var _a, _b, _c;\n            if ((_a = data === null || data === void 0 ? void 0 : data.loginResponse) === null || _a === void 0 ? void 0 : _a.flag) {\n                wx.switchTab({ url: '/pages/cart/index' });\n            }\n            else if ((_b = data === null || data === void 0 ? void 0 : data.loginResponse) === null || _b === void 0 ? void 0 : _b.errorMsg) {\n                wx.showToast({ title: (_c = data === null || data === void 0 ? void 0 : data.loginResponse) === null || _c === void 0 ? void 0 : _c.errorMsg });\n            }\n            else {\n                wx.showToast({ title: \"登录失败，请检查登录名称和密码\" });\n            }\n        });\n    },\n    goStep2: function () {\n        wx.navigateTo({ url: \"/pages/usercenter/validate-code/index\" });\n    },\n    onLoad: function () {\n        // checkWxSession();\n        wxLogin();\n    },\n    onShow: function () {\n        // this.getTabBar()?.init();\n    },\n    getPhoneNumber: function (e) {\n        var _a = e.detail, code = _a.code, errMsg = _a.errMsg, iv = _a.iv, encryptedData = _a.encryptedData;\n        console.log(\"[zy]e.detail\", code, e, errMsg, iv, encryptedData);\n        if (errMsg.startsWith('getPhoneNumber:fail ')) {\n            wx.showModal({\n                title: '获取失败',\n                showCancel: false,\n                content: errMsg,\n                success: function (res) { }\n            });\n        }\n        else {\n            wx.showModal({\n                title: '提示',\n                showCancel: false,\n                content: '同意授权',\n                success: function (res) {\n                    var _a;\n                    var _b = ((_a = getApp().globalData) === null || _a === void 0 ? void 0 : _a.session) || {}, openid = _b.openid, unionid = _b.unionid;\n                    phoneLoginService({ code: code, openid: openid, unionid: unionid });\n                }\n            });\n        }\n    },\n    onChangeOfRead: function (e) {\n        wx.showToast({ title: e.detail.checked + \"\" });\n    },\n    agreeUser: function (e) {\n        wx.showToast({ title: \"agreeUser\" });\n        return false;\n    },\n    agreePrivacy: function (e) {\n        wx.showToast({ title: \"agreePrivacy\" });\n        return false;\n    },\n    getVerificationCode: function (e) {\n        var reg = /^1[3|4|5|7|8][0-9]{9}$/;\n        var phone = this.data.userPhone;\n        var flag = reg.test(phone);\n        if (flag) {\n            var that = this;\n            var code;\n            this.setData({\n                isValated: true\n            });\n        }\n        else {\n            wx.showToast({\n                \"title\": \"手机号码不正确\"\n            });\n        }\n    },\n});\n"],"names":[],"sourceRoot":""}