{"version":3,"file":"pages/usercenter/login/account/index.js","mappings":";;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///./pages/usercenter/login/account/index.js"],"sourcesContent":["import { phoneLoginService, } from '../../../../services/usercenter/loginService';\nPage({\n    data: {\n        formData: { account: \"\" },\n        showPassword: false,\n        accountLogin: \"账号登录\",\n        stepDisabled: true,\n        readedPolicy: false,\n        isChecked: false,\n        navigatorProps: {\n            url: \"/pages/usercenter/register/account/index\"\n        }\n    },\n    changEye: function () {\n        this.setData({\n            showPassword: !this.data.showPassword\n        });\n    },\n    inputChange: function (e) {\n        var prop = e.currentTarget.dataset.prop;\n        var value = e.detail.value;\n        this.data.formData[prop] = value;\n        var flag = this.getVerificationCode(value);\n        // flag = true;\n        if (value.length > 11) {\n            wx.showToast({\n                \"title\": \"手机号码不正确\"\n            });\n        }\n        if (!flag) {\n            this.setData({\n                stepDisabled: true,\n            });\n        }\n        else {\n            this.setData({\n                stepDisabled: false,\n            });\n        }\n        this.setData({\n            formData: this.data.formData\n        });\n    },\n    goLine: function () {\n        this.goStep2();\n        wx.navigateTo({ url: \"/pages/line/index\" });\n    },\n    goStep2: function () {\n        var readedPolicy = this.data.readedPolicy;\n        if (readedPolicy) {\n            var account = this.data.formData.account;\n            wx.navigateTo({ url: \"/pages/usercenter/code/index?account=\" + account + \"&operate=login\" });\n        }\n        else {\n            wx.showToast({ title: \"请先阅读 服务协议和隐私政策\" });\n        }\n    },\n    onLoad: function () {\n        // checkWxSession();\n        // wxLogin();\n    },\n    onShow: function () {\n        // this.getTabBar()?.init();\n    },\n    getPhoneNumber: function (e) {\n        var _a, _b;\n        var prefix = \"[zy]getPhoneNumber\";\n        var _c = e.detail, code = _c.code, errMsg = _c.errMsg, iv = _c.iv, encryptedData = _c.encryptedData;\n        console.log(prefix, code, e, errMsg, iv, encryptedData);\n        if ((_a = this.data) === null || _a === void 0 ? void 0 : _a.readedPolicy) {\n            var account = this.data.formData.account;\n            if (errMsg.startsWith('getPhoneNumber:fail ')) {\n                wx.showModal({\n                    title: '获取失败',\n                    showCancel: false,\n                    content: errMsg,\n                    success: function (res) { }\n                });\n            }\n            else {\n                console.log(prefix, \"getPhoneNumber code success\");\n                var session = ((_b = getApp().globalData) === null || _b === void 0 ? void 0 : _b.session) || {};\n                var openid = session.openid, unionid = session.unionid;\n                phoneLoginService({ code: code, openid: openid, unionid: unionid }).then(function (data) {\n                    //微信快捷登录完成\n                    if (data) {\n                        wx.showModal({\n                            title: '提示',\n                            showCancel: false,\n                            content: '快捷登录成功',\n                            success: function (res) {\n                                wx.switchTab({ url: '/pages/cart/index' });\n                            }\n                        });\n                    }\n                    else {\n                        wx.showToast({ title: \"微信快捷登录失败\" });\n                    }\n                });\n            }\n        }\n        else {\n            wx.showToast({ title: \"请先阅读 服务协议和隐私政策\" });\n            return;\n        }\n    },\n    onChangeOfRead: function (e) {\n        wx.showToast({ title: JSON.stringify(e.detail) + \"---\" });\n        // wx.showToast({ title: e.detail.checked + \"\" });\n        this.setData({\n            readedPolicy: e.detail.checked,\n            isChecked: !this.data.isChecked,\n        });\n    },\n    agreeUser: function (e) {\n        wx.showToast({ title: \"agreeUser\" });\n        return false;\n    },\n    agreePrivacy: function (e) {\n        wx.showToast({ title: \"agreePrivacy\" });\n        return false;\n    },\n    getVerificationCode: function (phone) {\n        // https://developer.aliyun.com/article/1431953?spm=5176.26934562.main.1.33046d28Ikjk93\n        var reg = /^1[3-9][0-9]{9}$/;\n        var flag = reg.test(phone);\n        return flag;\n    },\n});\n"],"names":[],"sourceRoot":""}