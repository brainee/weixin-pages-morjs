{"version":3,"file":"pages/usercenter/login/pass/index.js","mappings":";;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///./pages/usercenter/login/pass/index.js"],"sourcesContent":["import { __awaiter, __generator } from \"tslib\";\n// pages/usercenter/validate-code/index.ts\nimport { getCurrentPageParam } from '../../../../utils/queryString';\nimport { wxLogin, getAccountSession } from '../../../../services/usercenter/loginService';\nPage({\n    /**\n     * 页面的初始数据\n     */\n    data: {\n        account: \"\",\n        showPassword: false,\n        formData: {},\n        stepDisabled: true,\n    },\n    /* 生命周期函数--监听页面加载 */\n    onLoad: function (options) {\n        // console.log(\"[zy]options=\",options);\n        var account = (getCurrentPageParam() || {}).account;\n        console.log(\"[zy]got from last page:account\", account);\n        this.setData({ account: account });\n    },\n    changEye: function () {\n        this.setData({\n            showPassword: !this.data.showPassword\n        });\n    },\n    inputChange: function (e) {\n        var prop = e.currentTarget.dataset.prop;\n        var value = e.detail.value;\n        this.setData({ stepDisabled: !value });\n        this.data.formData[prop] = value;\n        this.setData({\n            formData: this.data.formData\n        });\n    },\n    regain: function () {\n        var account = this.data.account;\n        wx.navigateTo({ url: \"/pages/usercenter/reset/account/index?account=\" + account + \"&operate=reset\" });\n    },\n    switchCode: function () {\n        console.log(\"[zy]switchCode\");\n        wx.navigateBack();\n    },\n    login: function (res) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var account, password, App, _b, openid, unionid;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        account = this.data.account;\n                        password = this.data.formData.password;\n                        App = getApp();\n                        _b = (_a = App === null || App === void 0 ? void 0 : App.globalData) === null || _a === void 0 ? void 0 : _a.session, openid = _b.openid, unionid = _b.unionid;\n                        if (!account) {\n                            wx.showToast({\n                                icon: 'none',\n                                title: \"账号不能为空\",\n                            });\n                            return [2 /*return*/];\n                        }\n                        if (!password) {\n                            wx.showToast({\n                                icon: 'none',\n                                title: \"密码不能为空\",\n                            });\n                            return [2 /*return*/];\n                        }\n                        if (!!openid) return [3 /*break*/, 2];\n                        wx.showToast({\n                            icon: 'none',\n                            title: \"需要先登录小程序\",\n                        });\n                        return [4 /*yield*/, wxLogin()];\n                    case 1:\n                        _c.sent();\n                        return [2 /*return*/];\n                    case 2:\n                        getAccountSession({\n                            account: account,\n                            password: password,\n                            openid: openid,\n                            unionid: unionid,\n                        }).then(function (data) {\n                            var _a, _b, _c;\n                            if ((_a = data === null || data === void 0 ? void 0 : data.loginResponse) === null || _a === void 0 ? void 0 : _a.flag) {\n                                wx.switchTab({ url: '/pages/cart/index' });\n                            }\n                            else if ((_b = data === null || data === void 0 ? void 0 : data.loginResponse) === null || _b === void 0 ? void 0 : _b.errorMsg) {\n                                wx.showToast({ title: (_c = data === null || data === void 0 ? void 0 : data.loginResponse) === null || _c === void 0 ? void 0 : _c.errorMsg });\n                            }\n                            else {\n                                wx.showToast({ title: \"登录失败，请检查登录名称和密码\" });\n                            }\n                        });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    },\n    /**\n     * 生命周期函数--监听页面显示\n     */\n    onShow: function () {\n    },\n    /**\n     * 生命周期函数--监听页面隐藏\n     */\n    onHide: function () {\n    },\n    /**\n     * 生命周期函数--监听页面卸载\n     */\n    onUnload: function () {\n    },\n    /**\n     * 页面相关事件处理函数--监听用户下拉动作\n     */\n    onPullDownRefresh: function () {\n    },\n    /**\n     * 页面上拉触底事件的处理函数\n     */\n    onReachBottom: function () {\n    },\n    /**\n     * 用户点击右上角分享\n     */\n    onShareAppMessage: function () {\n    }\n});\n"],"names":[],"sourceRoot":""}