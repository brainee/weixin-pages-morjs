{"version":3,"file":"pages/usercenter/register/pass/index.js","mappings":";;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///./pages/usercenter/register/pass/index.js"],"sourcesContent":["import { __awaiter, __generator } from \"tslib\";\n// pages/usercenter/validate-code/index.ts\nimport { getCurrentPageParam } from '../../../../utils/queryString';\nimport { registerService, } from '../../../../services/usercenter/registerService';\nimport { wxLogin } from '../../../../services/usercenter/loginService';\nimport { config } from '../../../../config/index';\nPage({\n    /**\n     * 页面的初始数据\n     */\n    data: {\n        account: \"\",\n        token: \"\",\n        showPassword: false,\n        formData: {},\n        stepDisabled: true,\n        operate: \"\",\n        mainTitle: \"设置登录密码\",\n    },\n    /* 生命周期函数--监听页面加载 */\n    onLoad: function (options) {\n        // console.log(\"[zy]options=\",options);\n        var _a = getCurrentPageParam() || {}, account = _a.account, token = _a.token, operate = _a.operate;\n        console.log(\"[zy]got from last page:account\", account);\n        if (!token) {\n            wx.showToast({ title: \"验证码错误，请重新尝试\" });\n            wx.navigateBack();\n            return;\n        }\n        var mainTitle = this.data.mainTitle;\n        if (operate == \"register\") {\n            mainTitle = \"设置登录密码\";\n        }\n        this.setData({ account: account, token: token, operate: operate, mainTitle: mainTitle });\n    },\n    changEye: function () {\n        this.setData({\n            showPassword: !this.data.showPassword\n        });\n    },\n    inputChange: function (e) {\n        var prop = e.currentTarget.dataset.prop;\n        var value = e.detail.value;\n        this.setData({ stepDisabled: !value });\n        this.data.formData[prop] = value;\n        this.setData({\n            formData: this.data.formData\n        });\n    },\n    inputChange2: function (e) {\n        var prop = e.currentTarget.dataset.prop;\n        var value = e.detail.value;\n        this.setData({ stepDisabled: !value });\n        this.data.formData[prop] = value;\n        this.setData({\n            formData: this.data.formData\n        });\n    },\n    setPass: function (res) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var _b, account, token, operate, _c, password, password2, App, _d, openid, unionid;\n            return __generator(this, function (_e) {\n                switch (_e.label) {\n                    case 0:\n                        _b = this.data, account = _b.account, token = _b.token, operate = _b.operate;\n                        _c = this.data.formData, password = _c.password, password2 = _c.password2;\n                        App = getApp();\n                        _d = (_a = App === null || App === void 0 ? void 0 : App.globalData) === null || _a === void 0 ? void 0 : _a.session, openid = _d.openid, unionid = _d.unionid;\n                        if (!account) {\n                            wx.showToast({\n                                icon: 'none',\n                                title: \"账号不能为空\",\n                            });\n                            return [2 /*return*/];\n                        }\n                        if (!password) {\n                            wx.showToast({\n                                icon: 'none',\n                                title: \"密码不能为空\",\n                            });\n                            return [2 /*return*/];\n                        }\n                        if (password != password2) {\n                            wx.showToast({\n                                icon: 'none',\n                                title: \"两次密码不一致\",\n                            });\n                            return [2 /*return*/];\n                        }\n                        if (!!openid) return [3 /*break*/, 2];\n                        wx.showToast({\n                            icon: 'none',\n                            title: \"需要先登录小程序\",\n                        });\n                        return [4 /*yield*/, wxLogin()];\n                    case 1:\n                        _e.sent();\n                        return [2 /*return*/];\n                    case 2:\n                        registerService({\n                            mobile: account,\n                            mobileprefix: config.default_mobile_prefix,\n                            password: password,\n                            token: token,\n                            operation: operate,\n                            openid: openid,\n                            unionid: unionid,\n                        }).then(function (data) {\n                            if (data) {\n                                wx.navigateTo({ url: \"/pages/usercenter/register/mail/index?account=\" + account + \"&operate=\" + operate });\n                            }\n                        });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    },\n    /**\n     * 生命周期函数--监听页面显示\n     */\n    onShow: function () {\n    },\n    /**\n     * 生命周期函数--监听页面隐藏\n     */\n    onHide: function () {\n    },\n    /**\n     * 生命周期函数--监听页面卸载\n     */\n    onUnload: function () {\n    },\n    /**\n     * 页面相关事件处理函数--监听用户下拉动作\n     */\n    onPullDownRefresh: function () {\n    },\n    /**\n     * 页面上拉触底事件的处理函数\n     */\n    onReachBottom: function () {\n    },\n    /**\n     * 用户点击右上角分享\n     */\n    onShareAppMessage: function () {\n    }\n});\n"],"names":[],"sourceRoot":""}