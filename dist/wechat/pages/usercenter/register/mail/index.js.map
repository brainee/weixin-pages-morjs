{"version":3,"file":"pages/usercenter/register/mail/index.js","mappings":";;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AChUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///./model/airline/index.js","webpack:///./model/airport/index.js","webpack:///./pages/usercenter/register/mail/index.js","webpack:///./services/airline/index.js","webpack:///./services/airport/index.js"],"sourcesContent":["import { request } from '../../utils/request';\nimport { domain } from '../../config/index';\nvar findAirlinesUrl = domain + \"/api/findAirlines\";\nexport function findAirlines(params) {\n    var prefix = \"[zy]findAirlines model\";\n    var url = findAirlinesUrl;\n    console.log(prefix, \"request start\", url);\n    return request({\n        url: url,\n        data: params,\n        method: \"POST\",\n    }).then(function (e) {\n        console.log(prefix, \"request success\", e);\n        return e;\n    }).catch(function (e) {\n        console.log(prefix, \"request fail\", e);\n    });\n}\n","import { request } from '../../utils/request';\nimport { domain } from '../../config/index';\nvar searchAreaUrl = domain + \"/api/searchArea\";\nexport function searchArea(params) {\n    var prefix = \"[zy]searchArea model\";\n    var url = searchAreaUrl;\n    console.log(prefix, \"request start\", url);\n    return request({\n        url: url,\n        data: params,\n        method: \"POST\",\n    }).then(function (e) {\n        console.log(prefix, \"request success\", e);\n        // if(config.useMock){\n        //   return areaData;\n        // }\n        return e;\n    }).catch(function (e) {\n        console.log(prefix, \"request fail\", e);\n    });\n}\n","import { __awaiter, __generator } from \"tslib\";\n// pages/usercenter/validate-code/index.ts\nimport { getCurrentPageParam } from '../../../../utils/queryString';\nimport { wxLogin, } from '../../../../services/usercenter/loginService';\nimport { trialService } from '../../../../services/usercenter/registerService';\nimport { config } from '../../../../config/index';\nimport { searchAreaService } from '../../../../services/airport/index';\nimport { findAirlinesService } from '../../../../services/airline/index';\nPage({\n    /**\n     * 页面的初始数据\n     */\n    data: {\n        mykeys: {\n            label: \"areaName\",\n            value: \"areaCode\",\n        },\n        account: \"\",\n        formData: {},\n        stepDisabled: true,\n        unitShowText: '',\n        unitTitle: '',\n        unitText: '',\n        unitValue: [],\n        airportText: '',\n        airportValue: [],\n        airportTitle: '',\n        airlineText: '',\n        airlineValue: [],\n        airlineTitle: '',\n        units: [\n            { label: \"机场\", value: \"1\", key: \"airport\" },\n            { label: \"航司\", value: \"2\", key: \"airline\" },\n            { label: \"其他\", value: \"3\", key: \"other\" },\n        ],\n        citys: [\n            { label: '北京市', value: '北京市' },\n            { label: '上海市', value: '上海市' },\n            { label: '广州市', value: '广州市' },\n            { label: '深圳市', value: '深圳市' },\n            { label: '成都市', value: '成都市' },\n        ],\n        airlines: []\n    },\n    /* 生命周期函数--监听页面加载 */\n    onLoad: function (options) {\n        // console.log(\"[zy]options=\",options);\n        var _a = getCurrentPageParam() || {}, account = _a.account, operate = _a.operate;\n        console.log(\"[zy]got from last page:account\", account, operate);\n        this.setData({ account: account, operate: operate });\n        var pass = this.checkBase();\n        // if(!pass){\n        //   return;\n        // }\n        this.searchArea();\n        this.findAirlines();\n    },\n    searchArea: function () {\n        var _this = this;\n        searchAreaService({\n            \"head\": { \"uid\": \"\", \"token\": \"\", \"requestTime\": \"2024-04-07T02:18:21.282Z\", \"appId\": \"\", \"clientType\": \"1\", \"clientVersion\": \"\", \"moduleCode\": \"common\", \"chartTableCode\": null },\n            \"type\": 1\n        }).then(function (data) {\n            if ((data === null || data === void 0 ? void 0 : data.length) > 0) {\n                _this.setData({ citys: data });\n            }\n        });\n    },\n    findAirlines: function () {\n        var _this = this;\n        findAirlinesService({\n            \"head\": { \"uid\": \"\", \"token\": \"\", \"requestTime\": \"2024-04-07T02:18:25.687Z\", \"appId\": \"\", \"clientType\": \"1\", \"clientVersion\": \"\", \"moduleCode\": \"common\", \"chartTableCode\": null },\n            \"type\": 1\n        }).then(function (data) {\n            if ((data === null || data === void 0 ? void 0 : data.length) > 0) {\n                _this.setData({ airlines: data });\n            }\n        });\n    },\n    onPickOfCascader: function (e) {\n        var prefix = \"[zy]onPickOfCascader\";\n        console.log(prefix, e.detail);\n    },\n    onChangeOfCascader: function (e) {\n        var _a;\n        var prefix = \"[zy]onChangeOfCascader\";\n        var _b = e.detail, selectedOptions = _b.selectedOptions, value = _b.value;\n        var unitText = this.data.unitText;\n        var airportText = (_a = selectedOptions[(selectedOptions === null || selectedOptions === void 0 ? void 0 : selectedOptions.length) - 1]) === null || _a === void 0 ? void 0 : _a.areaName;\n        console.log(prefix, e.detail);\n        this.setData({\n            airportValue: [value],\n            airportText: airportText,\n            airportVisible: false,\n            unitShowText: unitText + \":\" + airportText,\n        });\n    },\n    inputChange: function (e) {\n        var prop = e.currentTarget.dataset.prop;\n        var value = e.detail.value;\n        this.setData({ stepDisabled: !value });\n        this.data.formData[prop] = value;\n        this.setData({\n            formData: this.data.formData\n        });\n    },\n    onColumnChange: function (e) {\n        console.log('picker pick:', e);\n    },\n    onPickerChangeOfAirline: function (e) {\n        var _a;\n        var key = e.currentTarget.dataset.key;\n        var _b = e.detail, label = _b.label, value = _b.value;\n        var unitText = this.data.unitText;\n        var airlineText = label.join(' ');\n        console.log('picker change:', e.detail);\n        this.setData((_a = {},\n            _a[key + \"Visible\"] = false,\n            _a[key + \"Value\"] = value,\n            _a[key + \"Text\"] = label.join(' '),\n            _a.unitShowText = unitText + \":\" + airlineText,\n            _a));\n    },\n    onPickerChangeOfUnit: function (e) {\n        var _a;\n        var key = e.currentTarget.dataset.key;\n        var _b = e.detail, label = _b.label, value = _b.value;\n        var unitTypeKeys = this.data.units.map(function (unit) { return unit.key; }); //[\"airport\", \"airline\", \"other\"]\n        var unitTypeTitles = this.data.units.map(function (unit) { return unit.label; });\n        var index = value[0] - 1;\n        var typeKey = unitTypeKeys[index];\n        var typeTitle = unitTypeTitles[index];\n        console.log('picker change:', typeKey, e.detail);\n        var note = label.join(' ');\n        this.setData((_a = {},\n            _a[key + \"Visible\"] = false,\n            _a[key + \"Value\"] = value,\n            _a[key + \"Text\"] = note,\n            _a[typeKey + \"Visible\"] = true,\n            _a[typeKey + \"Title\"] = \"选择\" + typeTitle,\n            _a.unitShowText = note,\n            _a));\n    },\n    onPickerCancel: function (e) {\n        var _a;\n        var key = e.currentTarget.dataset.key;\n        console.log(e, '取消');\n        console.log('picker1 cancel:');\n        this.setData((_a = {},\n            _a[key + \"Visible\"] = false,\n            _a));\n    },\n    onTitlePicker: function () {\n        this.setData({ unitVisible: true, unitTitle: '选择单位' });\n    },\n    inputChange2: function (e) {\n        var prop = e.currentTarget.dataset.prop;\n        var value = e.detail.value;\n        this.data.formData[prop] = value;\n        this.setData({\n            formData: this.data.formData\n        });\n    },\n    inputChangeNormal: function (e) {\n        var prop = e.currentTarget.dataset.prop;\n        var value = e.detail.value;\n        this.data.formData[prop] = value;\n        this.setData({\n            formData: this.data.formData\n        });\n        var pass = this.check();\n        this.setData({ stepDisabled: !pass });\n    },\n    getMainUnit: function () {\n        var _a = this.data, unitValue = _a.unitValue, airportText = _a.airportText, airportValue = _a.airportValue, airlineText = _a.airlineText, airlineValue = _a.airlineValue;\n        var unit = this.data.formData.unit;\n        var mainUnitName = \"\", mainUnitCode = \"\";\n        var demoType = +unitValue[0] || 0;\n        if (demoType === 1) {\n            mainUnitName = airportText,\n                mainUnitCode = airportValue[0];\n        }\n        else if (demoType === 2) {\n            mainUnitName = airlineText,\n                mainUnitCode = airlineValue[0];\n        }\n        else {\n            mainUnitName = unit;\n        }\n        return {\n            mainUnitName: mainUnitName,\n            mainUnitCode: mainUnitCode,\n            demoType: demoType,\n        };\n    },\n    checkBase: function () {\n        var _a;\n        var account = this.data.account;\n        if (!account) {\n            wx.showToast({\n                icon: 'none',\n                title: \"账号不能为空\",\n            });\n            return;\n        }\n        var App = getApp();\n        var _b = (_a = App === null || App === void 0 ? void 0 : App.globalData) === null || _a === void 0 ? void 0 : _a.session, openid = _b.openid, unionid = _b.unionid;\n        if (!openid) {\n            wx.showToast({\n                icon: 'none',\n                title: \"需要先登录小程序\",\n            });\n            wxLogin();\n            return;\n        }\n        return true;\n    },\n    check: function (showTip) {\n        var _a = this.data.formData, name = _a.name, depart = _a.depart, mail = _a.mail;\n        var _b = this.getMainUnit(), mainUnitName = _b.mainUnitName, mainUnitCode = _b.mainUnitCode;\n        if (!name) {\n            showTip && wx.showToast({\n                icon: 'none',\n                title: \"真实姓名不能为空\",\n            });\n            return;\n        }\n        if (!depart) {\n            showTip && wx.showToast({\n                icon: 'none',\n                title: \"部门不能为空\",\n            });\n            return;\n        }\n        if (!mail) {\n            showTip && wx.showToast({\n                icon: 'none',\n                title: \"邮箱不能为空\",\n            });\n            return;\n        }\n        if (!mainUnitName) {\n            showTip && wx.showToast({\n                icon: 'none',\n                title: \"单位不能为空\",\n            });\n            return;\n        }\n        return true;\n    },\n    submit: function (res) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function () {\n            var pass, account, _b, name, depart, mail, App, _c, openid, unionid, _d, mainUnitName, mainUnitCode, demoType;\n            return __generator(this, function (_e) {\n                pass = this.check(true);\n                if (!pass)\n                    return [2 /*return*/];\n                account = this.data.account;\n                _b = this.data.formData, name = _b.name, depart = _b.depart, mail = _b.mail;\n                App = getApp();\n                _c = (_a = App === null || App === void 0 ? void 0 : App.globalData) === null || _a === void 0 ? void 0 : _a.session, openid = _c.openid, unionid = _c.unionid;\n                _d = this.getMainUnit(), mainUnitName = _d.mainUnitName, mainUnitCode = _d.mainUnitCode, demoType = _d.demoType;\n                trialService({\n                    name: name,\n                    mobileprefix: config.default_mobile_prefix,\n                    mobile: account,\n                    mail: mail,\n                    mainUnitName: mainUnitName,\n                    mainUnitCode: mainUnitCode,\n                    remark: \"\",\n                    depart: depart,\n                    title: \"\",\n                    budget: 0,\n                    persons: 0,\n                    demoType: demoType,\n                    openid: openid,\n                    unionid: unionid,\n                }).then(function (data) {\n                    if (data) {\n                        wx.navigateTo({ url: '/pages/usercenter/register/finish/index' });\n                    }\n                    else {\n                        wx.showToast({ title: \" 注册失败，请重试\" });\n                    }\n                });\n                return [2 /*return*/];\n            });\n        });\n    },\n    /**\n     * 生命周期函数--监听页面显示\n     */\n    onShow: function () {\n    },\n    /**\n     * 生命周期函数--监听页面隐藏\n     */\n    onHide: function () {\n    },\n    /**\n     * 生命周期函数--监听页面卸载\n     */\n    onUnload: function () {\n    },\n    /**\n     * 页面相关事件处理函数--监听用户下拉动作\n     */\n    onPullDownRefresh: function () {\n    },\n    /**\n     * 页面上拉触底事件的处理函数\n     */\n    onReachBottom: function () {\n    },\n    /**\n     * 用户点击右上角分享\n     */\n    onShareAppMessage: function () {\n    }\n});\n","import { findAirlines } from '../../model/airline/index';\nexport function findAirlinesService(params) {\n    var prefix = \"[zy]findAirlinesService\";\n    console.log(prefix, \"service start\", params);\n    return findAirlines(params).then(function (res) {\n        console.log(prefix, \"service got\", res);\n        if (res.data) {\n            return res.data.map(function (airline) {\n                return { label: airline.airlinesName, value: airline.airlinesCode };\n            });\n        }\n    });\n}\n","import { searchArea } from '../../model/airport/index';\nexport function searchAreaService(params) {\n    var prefix = \"[zy]searchAreaService\";\n    console.log(prefix, \"service start\", params);\n    return searchArea(params).then(function (res) {\n        // console.log(prefix,\"service got\",res);\n        if (res === null || res === void 0 ? void 0 : res.data) {\n            return res.data;\n        }\n    });\n}\n"],"names":[],"sourceRoot":""}